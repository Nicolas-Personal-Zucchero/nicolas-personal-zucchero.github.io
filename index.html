<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Scan Lotto</title>
</head>
<body>
<h3>Caricamento...</h3>

<!-- Firebase App -->
<script src="https://www.gstatic.com/firebasejs/9.24.0/firebase-app-compat.js"></script>
<!-- Firestore -->
<script src="https://www.gstatic.com/firebasejs/9.24.0/firebase-firestore-compat.js"></script>
<!-- Functions (opzionale) -->
<script src="https://www.gstatic.com/firebasejs/9.24.0/firebase-functions-compat.js"></script>

<script>
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-app.js";

const firebaseConfig = {
apiKey: "AIzaSyAIXVjhG_rWSrLil-7SavwnwhQ2iSntVq0",
authDomain: "personal-zucchero.firebaseapp.com",
projectId: "personal-zucchero",
storageBucket: "personal-zucchero.firebasestorage.app",
messagingSenderId: "774491547691",
appId: "1:774491547691:web:8b5172811785f68238a26e",
measurementId: "G-ZVTMDKFHKP"
};

firebase.initializeApp(firebaseConfig);

const db = firebase.firestore();

const params = new URLSearchParams(window.location.search);
const lottoId = params.get("lottoId");

if (lottoId) {
    const lottoRef = db.collection("lotti_zucchero").doc(lottoId);
    lottoRef.update({ loaded_at: firebase.firestore.FieldValue.serverTimestamp() })
        .then(() => document.body.innerHTML = "<h3>Lotto aggiornato con successo!</h3>")
        .catch(err => document.body.innerHTML = `<h3>Errore: ${err.message}</h3>`);
} else {
    document.body.innerHTML = "<h3>ID lotto mancante!</h3>";
}
</script>
</body>
</html>
